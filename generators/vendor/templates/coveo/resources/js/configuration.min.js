var Coveo;!function(e){e.t=function(t,o){return $(e.loadTemplate(t,o))},e.loadTemplate=function(t,o){null==o&&(o={}),null==e.templates&&(e.templates={}),null==e.Provisioning.templates&&(e.Provisioning.templates={}),null==e.Configuration.templates&&(e.Configuration.templates={}),o.t=o.t||e.loadTemplate;var n=e.templates[t]?e.templates[t]:e.Provisioning.templates[t]?e.Provisioning.templates[t]:e.Configuration.templates[t];return n(o)}}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){t.t=e.t}(t=e.Provisioning||(e.Provisioning={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){t.t=e.t}(t=e.Configuration||(e.Configuration={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.element=e,this.baseResourcesUrl=t}return t.prototype.setSourcesStatus=function(t){t&&0!=t.length&&(this.tableSection&&this.tableSection.remove(),this.tableSection=e.t("table",{tableRows:t}).appendTo(this.element))},t.prototype.prepareRefresh=function(){this.tableSection||(this.tableSection=e.t("tableWaiting",{baseResourcesUrl:this.baseResourcesUrl}).appendTo(this.element))},t}();e.StandaloneIndexContent=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){!function(e){e[e.ANONYMOUS=0]="ANONYMOUS",e[e.STANDARD=1]="STANDARD"}(t.UserQueryProfileChoice||(t.UserQueryProfileChoice={}));var o=t.UserQueryProfileChoice;!function(e){e[e.FULL=0]="FULL",e[e.USERNAMEONLY=1]="USERNAMEONLY",e[e.NONE=2]="NONE"}(t.UserObfuscateChoice||(t.UserObfuscateChoice={}));var n=t.UserObfuscateChoice,i=function(){function i(s,c){var a=this;this.element=s,this.options=c,this.userQueryProfileChoiceButton={ANONYMOUS:{selected:!1,element:void 0,choice:o.ANONYMOUS},STANDARD:{selected:!1,element:void 0,choice:o.STANDARD}},this.userObfuscateChoiceButton={FULL:{selected:!1,element:void 0,choice:n.FULL},USERNAMEONLY:{selected:!1,element:void 0,choice:n.USERNAMEONLY},NONE:{selected:!1,element:void 0,choice:n.NONE}},this.options=_.extend(i.defaultOptions,c),this.configurationSearchSection=t.t("searchConfiguration_container",this.options).appendTo(this.element),this.relatedActionSection=t.t("relatedActions_container",this.options).appendTo(this.element),this.relatedActionSection.find(".coveo-configure-advanced-button").click(function(){a.configurationAdvancedSection.is(":visible")?a.hideAdvancedConfig():a.showAdvancedConfig()}),this.relatedActionSection.find(".coveo-reset-configuration").click(function(){a.options.onResetConfig()}),this.buildAdvanceConfigSection(),this.hideAdvancedConfig(),this.sourceStatusSection=t.t("sourceStatus_container").appendTo(this.element),this.options.disableSourceStatus||(this.standaloneIndexContent=new e.StandaloneIndexContent(this.sourceStatusSection,this.options.baseResourcesUrl),this.standaloneIndexContent.prepareRefresh(),this.options.refreshStatus(),setInterval(function(){return a.options.refreshStatus()},5e3))}return i.prototype.hideSourceStatusSection=function(e){e?this.sourceStatusSection.hide():this.sourceStatusSection.show()},i.prototype.setSourceStatus=function(e){this.standaloneIndexContent&&this.standaloneIndexContent.setSourcesStatus(e)},i.prototype.setAsAlreadSelectedQueryProfile=function(e){this.setAsSelectedProfileConfig(e),this.setNotSavedYet(this.saveAdvancedButton)},i.prototype.setAsAlreadSelectedObfuscate=function(e){this.setAsSelectedObfuscateConfig(e),this.setNotSavedYet(this.saveAdvancedButton)},i.prototype.setAsSelectedProfileConfig=function(e){_.each(this.userQueryProfileChoiceButton,function(e){e.element.removeClass("coveo-selected"),e.selected=!1}),this.userQueryProfileChoiceButton[o[e]].element.addClass("coveo-selected"),this.userQueryProfileChoiceButton[o[e]].selected=!0,this.setNotSavedYet(this.saveAdvancedButton)},i.prototype.setAsSelectedObfuscateConfig=function(e){_.each(this.userObfuscateChoiceButton,function(e){e.element.removeClass("coveo-selected"),e.selected=!1}),this.userObfuscateChoiceButton[n[e]].element.addClass("coveo-selected"),this.userObfuscateChoiceButton[n[e]].selected=!0,this.setNotSavedYet(this.saveAdvancedButton)},i.prototype.showAdvancedConfig=function(){this.configurationAdvancedSection.show();var e=this.relatedActionSection.find(".coveo-configure-advanced-button");e.removeClass("coveo-right-arrow"),e.addClass("coveo-down-arrow")},i.prototype.hideAdvancedConfig=function(){this.configurationAdvancedSection.hide();var e=this.relatedActionSection.find(".coveo-configure-advanced-button");e.removeClass("coveo-down-arrow"),e.addClass("coveo-right-arrow")},i.prototype.buildAdvanceConfigSection=function(){var e=this;this.configurationAdvancedSection=t.t("advanced_container",this.options).appendTo(this.element),this.saveAdvancedButton=this.configurationAdvancedSection.find(".coveo-configure-save");var i=_.map(this.configurationAdvancedSection.find(".coveo-user-profile .coveo-configuration-button"),function(e){return $(e)}),s=_.map(this.configurationAdvancedSection.find(".coveo-user-obfuscate .coveo-configuration-button"),function(e){return $(e)});_.each(i,function(t){e.userQueryProfileChoiceButton[e.fromClassToButton(t)].element=t,t.click(function(){e.setAsSelectedProfileConfig(o[e.fromClassToButton(t)])})}),_.each(s,function(t){e.userObfuscateChoiceButton[e.fromClassToButton(t)].element=t,t.click(function(){e.setAsSelectedObfuscateConfig(n[e.fromClassToButton(t)])})}),this.saveAdvancedButton.click(function(){var t=_.find(e.userQueryProfileChoiceButton,function(e){return e.selected}),n=_.find(e.userObfuscateChoiceButton,function(e){return e.selected});e.options.onSaveAdvancedConfig(t.choice==o.ANONYMOUS,e.fromObfuscationEnumToString(n.choice)),e.setSaved(e.saveAdvancedButton)}),this.configurationAdvancedSection.find(".coveo-advanced-close").click(function(){return e.hideAdvancedConfig()})},i.prototype.fromClassToButton=function(e){return e.hasClass("coveo-configuration-anonymous-profile")?o[o.ANONYMOUS]:e.hasClass("coveo-configuration-standard-profile")?o[o.STANDARD]:e.hasClass("coveo-configuration-full-obfuscate")?n[n.FULL]:e.hasClass("coveo-configuration-username-obfuscate")?n[n.USERNAMEONLY]:e.hasClass("coveo-configuration-no-obfuscate")?n[n.NONE]:void 0},i.prototype.setNotSavedYet=function(e){e.addClass("coveo-not-saved-yet"),e.removeClass("coveo-saved"),e.text("Not saved"),e.html(this.getSaveButtonContent(!1))},i.prototype.setSaved=function(e){e.addClass("coveo-saved"),e.removeClass("coveo-not-saved-yet"),e.html(this.getSaveButtonContent(!0))},i.prototype.getSaveButtonContent=function(e){var t=e?"Saved".toLocaleString():"SaveChanges".toLocaleString();return'<span class="coveo-save-checkmark">&#10004;</span> '+t},i.prototype.fromObfuscationEnumToString=function(e){return e==n.FULL?"ObfuscateAll":e==n.USERNAMEONLY?"ObfuscatePreAt":"DoNotObfuscate"},i.defaultOptions={baseResourcesUrl:"",refreshStatus:function(){},onSaveAdvancedConfig:function(e,t){console.log(e,t)},searchPageConfigurationUrl:"https://onlinehelp.coveo.com",panelConfigurationUrl:"https://onlinehelp.coveo.com",searchPageUrl:"https://onlinehelp.coveo.com",onResetConfig:function(){console.log("resetting")},disableSourceStatus:!1},i}();t.ConfigurationPanel=i}(t=e.Configuration||(e.Configuration={}))}(Coveo||(Coveo={}));